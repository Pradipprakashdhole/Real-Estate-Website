<%- include('partials/head') %>
<style>
@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.animate-fadeInUp {
  animation: fadeInUp 0.6s ease-in-out;
}
</style>
</head>

<body class="bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-white">
  <%- include('partials/navbar') %>

  <div class="container py-5 px-4 animate-fadeInUp">

    <!-- User Profile Section -->
    <div class="row mb-5 align-items-center">
      <div class="col-md-2 text-center">
        <img src="<%= user.profileImage ? user.profileImage : '/images/default-user.png' %>" 
             class="rounded-circle border shadow" 
             width="100" height="100" alt="Profile Picture">
      </div>
      <div class="col-md-8">
        <h2 class="fw-bold mb-1"><%= user.name %></h2>
        <p class="text-muted mb-1"><i class="bi bi-envelope"></i> <%= user.email %></p>
        <p class="text-muted mb-0"><i class="bi bi-telephone-fill me-2"></i> <%= user.mobile || "Not Provided" %></p>
      </div>
      <div class="col-md-2 text-end">
        <a href="/profile" class="btn btn-primary">Edit Profile</a>
      </div>
    </div>

    <!-- Dashboard Cards -->
    <div class="row g-4 mb-5">
      <div class="col-md-3">
        <div class="card shadow bg-primary text-white h-100">
          <div class="card-body text-center">
            <h5 class="card-title">My Properties</h5>
            <p class="fs-3 fw-bold"><%= properties.length %></p>
            <a href="/add-property" class="btn btn-light btn-sm">Add New</a>
          </div>
        </div>
      </div>
      <div class="col-md-3">
        <div class="card shadow bg-success text-white h-100">
          <div class="card-body text-center">
            <h5 class="card-title">Favorites</h5>
            <p class="fs-3 fw-bold"><%= user.favorites ? user.favorites.length : 0 %></p>
            <a href="/favorites" class="btn btn-light btn-sm">View</a>
          </div>
        </div>
      </div>
      <div class="col-md-3">
        <div class="card shadow bg-warning text-white h-100">
          <div class="card-body text-center">
            <h5 class="card-title">Profile</h5>
            <p class="fs-3 fw-bold">Update</p>
            <a href="/profile" class="btn btn-light btn-sm">Edit</a>
          </div>
        </div>
      </div>
      <div class="col-md-3">
        <div class="card shadow bg-danger text-white h-100">
          <div class="card-body text-center">
            <h5 class="card-title">Logout</h5>
            <p class="fs-3 fw-bold">Exit</p>
            <a href="/logout" class="btn btn-light btn-sm">Logout</a>
          </div>
        </div>
      </div>
    </div>

    <!-- Property Listings -->
    <div class="d-flex justify-content-between align-items-center mb-4">
      <h3 class="fw-bold">My Property Listings</h3>
      <a href="/add-property" class="btn btn-primary">+ Post Property</a>
    </div>

    <% if (properties.length === 0) { %>
      <p class="text-muted">You haven't posted any properties yet. <a href="/add-property">Post now</a>.</p>
    <% } else { %>
      <div class="row">
        <% properties.forEach(property => { %>
          <div class="col-md-4 mb-4">
            <div class="card h-100 shadow border-0">
              <img src="<%= property.image || '/images/placeholder.jpg' %>" 
                   alt="Property" 
                   class="card-img-top" 
                   style="height: 200px; object-fit: cover;"
                   onerror="this.src='/images/placeholder.jpg'">
              <div class="card-body d-flex flex-column">
                <h5 class="card-title"><%= property.title %></h5>
                <p class="text-muted"><i class="bi bi-geo-alt-fill"></i> <%= property.location %></p>
                <p class="fw-bold text-primary">â‚¹ <%= property.price.toLocaleString() %></p>

                <div class="mt-auto d-flex justify-content-between gap-2 pt-2">
                  <a href="/property/<%= property._id %>" class="btn btn-outline-primary btn-sm">View</a>
                  <a href="/edit-property/<%= property._id %>" class="btn btn-outline-warning btn-sm">Edit</a>
                  <form action="/delete-property/<%= property._id %>" method="POST"
                        onsubmit="return confirm('Are you sure you want to delete this property?')">
                    <button type="submit" class="btn btn-outline-danger btn-sm">Delete</button>
                  </form>
                </div>
              </div>
            </div>
          </div>
        <% }) %>
      </div>
    <% } %>
  </div>

  <%- include('partials/footer') %>
</body>
</html>
